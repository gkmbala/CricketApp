<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ğŸ Cricket AI Dashboard</title>
<link href="https://fonts.googleapis.com/css2?family=Bebas+Neue&family=DM+Sans:wght@300;400;500;600&family=JetBrains+Mono:wght@400;600&display=swap" rel="stylesheet">
<style>
  :root {
    --green:   #00e676;
    --lime:    #c6ff00;
    --red:     #ff1744;
    --gold:    #ffd600;
    --bg:      #060d06;
    --surface: #0d1a0d;
    --card:    #111f11;
    --border:  #1e3a1e;
    --text:    #e8f5e9;
    --muted:   #558b55;
  }

  *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

  body {
    background: var(--bg);
    color: var(--text);
    font-family: 'DM Sans', sans-serif;
    min-height: 100vh;
    overflow-x: hidden;
  }

  /* â”€â”€ Noise overlay â”€â”€ */
  body::before {
    content: '';
    position: fixed; inset: 0;
    background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 200 200' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.75' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23n)' opacity='0.04'/%3E%3C/svg%3E");
    pointer-events: none; z-index: 0; opacity: .5;
  }

  /* â”€â”€ Header â”€â”€ */
  header {
    position: relative; z-index: 10;
    display: flex; align-items: center; justify-content: space-between;
    padding: 1.2rem 2rem;
    border-bottom: 1px solid var(--border);
    background: linear-gradient(90deg, #060d06 0%, #0a1a08 100%);
  }

  .logo {
    display: flex; align-items: center; gap: .7rem;
  }
  .logo-icon {
    font-size: 1.8rem;
    animation: spin 8s linear infinite;
  }
  @keyframes spin { to { transform: rotate(360deg); } }
  .logo-text {
    font-family: 'Bebas Neue', sans-serif;
    font-size: 1.8rem;
    letter-spacing: 2px;
    color: var(--green);
    text-shadow: 0 0 20px rgba(0,230,118,.4);
  }
  .logo-sub { font-size: .7rem; color: var(--muted); letter-spacing: 3px; text-transform: uppercase; }

  .header-right { display: flex; align-items: center; gap: 1rem; }

  .live-badge {
    display: flex; align-items: center; gap: .4rem;
    background: rgba(255,23,68,.15);
    border: 1px solid rgba(255,23,68,.4);
    border-radius: 20px;
    padding: .3rem .8rem;
    font-size: .75rem; font-weight: 600;
    color: var(--red);
    letter-spacing: 1px;
    text-transform: uppercase;
  }
  .live-dot {
    width: 7px; height: 7px;
    border-radius: 50%;
    background: var(--red);
    animation: pulse 1s infinite;
  }
  @keyframes pulse {
    0%,100% { opacity: 1; transform: scale(1); }
    50%      { opacity: .4; transform: scale(.8); }
  }

  #clock {
    font-family: 'JetBrains Mono', monospace;
    font-size: .85rem; color: var(--muted);
  }

  /* â”€â”€ API Config Bar â”€â”€ */
  .api-bar {
    position: relative; z-index: 10;
    background: var(--surface);
    border-bottom: 1px solid var(--border);
    padding: .8rem 2rem;
    display: flex; align-items: center; gap: 1rem; flex-wrap: wrap;
  }
  .api-bar label { font-size: .78rem; color: var(--muted); text-transform: uppercase; letter-spacing: 1px; }
  .api-bar input {
    flex: 1; min-width: 200px; max-width: 380px;
    background: var(--card);
    border: 1px solid var(--border);
    border-radius: 6px;
    padding: .45rem .8rem;
    color: var(--text);
    font-family: 'JetBrains Mono', monospace;
    font-size: .82rem;
    outline: none;
    transition: border-color .2s;
  }
  .api-bar input:focus { border-color: var(--green); }
  .btn {
    background: var(--green);
    color: #060d06;
    border: none; border-radius: 6px;
    padding: .48rem 1.2rem;
    font-weight: 700; font-size: .82rem;
    cursor: pointer;
    transition: opacity .2s, transform .1s;
  }
  .btn:hover { opacity: .85; }
  .btn:active { transform: scale(.97); }
  .btn-demo {
    background: transparent;
    border: 1px solid var(--border);
    color: var(--muted);
  }
  .btn-demo:hover { border-color: var(--green); color: var(--green); }
  .api-hint {
    font-size: .72rem; color: var(--muted);
  }
  .api-hint a { color: var(--green); text-decoration: none; }
  .api-hint a:hover { text-decoration: underline; }

  /* â”€â”€ Groq AI Bar â”€â”€ */
  .ai-bar {
    position: relative; z-index: 10;
    background: linear-gradient(90deg, rgba(0,230,118,.05) 0%, transparent 100%);
    border-bottom: 1px solid var(--border);
    padding: .8rem 2rem;
    display: flex; align-items: center; gap: 1rem; flex-wrap: wrap;
  }
  .ai-bar input {
    flex: 1; min-width: 260px;
    background: var(--card);
    border: 1px solid rgba(0,230,118,.2);
    border-radius: 6px;
    padding: .45rem .8rem;
    color: var(--text);
    font-size: .88rem;
    outline: none;
    transition: border-color .2s;
  }
  .ai-bar input:focus { border-color: var(--green); }
  .ai-bar input::placeholder { color: var(--muted); }
  .btn-ai {
    background: linear-gradient(135deg, var(--green), var(--lime));
    color: #060d06; font-weight: 700;
    border: none; border-radius: 6px;
    padding: .48rem 1.2rem; font-size: .82rem;
    cursor: pointer; transition: opacity .2s;
  }
  .btn-ai:hover { opacity: .85; }
  .ai-label {
    font-size: .78rem; color: var(--green);
    font-weight: 600; letter-spacing: 1px;
    text-transform: uppercase;
    white-space: nowrap;
  }

  /* â”€â”€ AI Response Box â”€â”€ */
  #ai-response {
    display: none;
    position: relative; z-index: 10;
    margin: 1rem 2rem;
    background: var(--card);
    border: 1px solid rgba(0,230,118,.25);
    border-radius: 10px;
    padding: 1rem 1.2rem;
    font-size: .9rem;
    line-height: 1.6;
    animation: fadeIn .3s ease;
  }
  @keyframes fadeIn { from { opacity:0; transform: translateY(-6px); } to { opacity:1; transform: none; } }
  .ai-response-header {
    display: flex; align-items: center; gap: .5rem;
    margin-bottom: .6rem;
    font-size: .75rem; font-weight: 600;
    color: var(--green); text-transform: uppercase; letter-spacing: 1px;
  }

  /* â”€â”€ Layout â”€â”€ */
  main {
    position: relative; z-index: 5;
    max-width: 1400px;
    margin: 0 auto;
    padding: 1.5rem 2rem 3rem;
  }

  .section-title {
    font-family: 'Bebas Neue', sans-serif;
    font-size: 1.1rem;
    letter-spacing: 3px;
    color: var(--muted);
    text-transform: uppercase;
    margin-bottom: 1rem;
    display: flex; align-items: center; gap: .6rem;
  }
  .section-title::after {
    content: ''; flex: 1; height: 1px;
    background: var(--border);
  }

  /* â”€â”€ Match Cards Grid â”€â”€ */
  .matches-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(340px, 1fr));
    gap: 1.2rem;
    margin-bottom: 2.5rem;
  }

  .match-card {
    background: var(--card);
    border: 1px solid var(--border);
    border-radius: 12px;
    overflow: hidden;
    transition: transform .2s, box-shadow .2s, border-color .2s;
    animation: cardIn .4s ease both;
    cursor: pointer;
  }
  @keyframes cardIn {
    from { opacity:0; transform: translateY(12px); }
    to   { opacity:1; transform: none; }
  }
  .match-card:hover {
    transform: translateY(-3px);
    box-shadow: 0 12px 40px rgba(0,230,118,.1);
    border-color: rgba(0,230,118,.3);
  }

  .card-header {
    display: flex; justify-content: space-between; align-items: center;
    padding: .7rem 1rem;
    background: rgba(0,230,118,.04);
    border-bottom: 1px solid var(--border);
  }
  .match-type {
    font-size: .7rem; font-weight: 700;
    letter-spacing: 2px; text-transform: uppercase;
    color: var(--lime);
    background: rgba(198,255,0,.1);
    border-radius: 4px;
    padding: .2rem .5rem;
  }
  .match-status {
    font-size: .72rem; font-weight: 600;
    padding: .2rem .6rem; border-radius: 20px;
  }
  .status-live   { background: rgba(255,23,68,.15);  color: var(--red);   border: 1px solid rgba(255,23,68,.3);  }
  .status-result { background: rgba(85,139,85,.15);  color: #81c784;     border: 1px solid rgba(85,139,85,.3);  }
  .status-upcoming { background: rgba(255,214,0,.1); color: var(--gold); border: 1px solid rgba(255,214,0,.3); }

  .card-body { padding: 1rem; }

  .teams { display: flex; flex-direction: column; gap: .6rem; }

  .team-row {
    display: flex; align-items: center; justify-content: space-between;
    gap: .5rem;
  }
  .team-info { display: flex; align-items: center; gap: .6rem; flex: 1; min-width: 0; }
  .team-flag {
    width: 28px; height: 20px;
    border-radius: 3px;
    font-size: 1.2rem;
    display: flex; align-items: center; justify-content: center;
    flex-shrink: 0;
  }
  .team-name {
    font-weight: 600; font-size: .95rem;
    white-space: nowrap; overflow: hidden; text-overflow: ellipsis;
  }
  .team-score {
    font-family: 'JetBrains Mono', monospace;
    font-size: 1rem; font-weight: 600;
    color: var(--green);
    white-space: nowrap;
  }
  .team-score.batting { color: var(--lime); }
  .team-overs {
    font-size: .72rem; color: var(--muted);
    font-family: 'JetBrains Mono', monospace;
  }

  .divider {
    height: 1px; background: var(--border);
    margin: .6rem 0;
  }

  .card-footer {
    display: flex; align-items: center; justify-content: space-between;
    padding: .6rem 1rem;
    background: rgba(0,0,0,.2);
    font-size: .75rem; color: var(--muted);
  }
  .venue { display: flex; align-items: center; gap: .3rem; }
  .crr { font-family: 'JetBrains Mono', monospace; color: var(--green); font-size: .78rem; }

  /* â”€â”€ Stats Row â”€â”€ */
  .stats-row {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
    gap: 1rem;
    margin-bottom: 2.5rem;
  }
  .stat-card {
    background: var(--card);
    border: 1px solid var(--border);
    border-radius: 10px;
    padding: 1.1rem 1.2rem;
    display: flex; align-items: center; gap: .8rem;
    transition: border-color .2s;
  }
  .stat-card:hover { border-color: var(--green); }
  .stat-icon { font-size: 1.6rem; }
  .stat-val {
    font-family: 'Bebas Neue', sans-serif;
    font-size: 1.8rem;
    color: var(--green);
    line-height: 1;
  }
  .stat-lbl { font-size: .72rem; color: var(--muted); text-transform: uppercase; letter-spacing: 1px; }

  /* â”€â”€ Scoreboard detail â”€â”€ */
  .scoreboard-wrap {
    background: var(--card);
    border: 1px solid var(--border);
    border-radius: 12px;
    overflow: hidden;
    margin-bottom: 2.5rem;
  }
  .scoreboard-head {
    background: rgba(0,230,118,.06);
    border-bottom: 1px solid var(--border);
    padding: .9rem 1.2rem;
    display: flex; justify-content: space-between; align-items: center;
  }
  .scoreboard-title {
    font-family: 'Bebas Neue', sans-serif;
    font-size: 1rem; letter-spacing: 2px;
    color: var(--green);
  }
  .score-big {
    font-family: 'JetBrains Mono', monospace;
    font-size: 1.5rem; font-weight: 700;
    color: var(--lime);
  }
  table {
    width: 100%; border-collapse: collapse;
    font-size: .83rem;
  }
  th {
    background: rgba(0,0,0,.3);
    color: var(--muted); font-weight: 600;
    text-transform: uppercase; letter-spacing: 1px; font-size: .7rem;
    padding: .6rem 1rem;
    text-align: left;
  }
  td {
    padding: .6rem 1rem;
    border-bottom: 1px solid rgba(30,58,30,.5);
    color: var(--text);
    vertical-align: middle;
  }
  tr:last-child td { border-bottom: none; }
  tr:hover td { background: rgba(0,230,118,.03); }
  .batting-icon { color: var(--lime); margin-left: .3rem; font-size: .7rem; }
  .wicket { color: var(--red); }
  .highlight { color: var(--green); font-weight: 600; }

  /* â”€â”€ Recent balls â”€â”€ */
  .balls-row {
    display: flex; gap: .4rem; flex-wrap: wrap;
    padding: .8rem 1.2rem;
    background: rgba(0,0,0,.2);
    border-top: 1px solid var(--border);
  }
  .ball {
    width: 32px; height: 32px;
    border-radius: 50%;
    display: flex; align-items: center; justify-content: center;
    font-size: .8rem; font-weight: 700;
    font-family: 'JetBrains Mono', monospace;
    border: 1.5px solid;
    transition: transform .15s;
  }
  .ball:hover { transform: scale(1.15); }
  .ball-0  { background: rgba(85,139,85,.15); border-color: var(--muted);   color: var(--muted); }
  .ball-1, .ball-2, .ball-3 { background: rgba(0,230,118,.12); border-color: var(--green); color: var(--green); }
  .ball-4  { background: rgba(198,255,0,.15);  border-color: var(--lime);  color: var(--lime); }
  .ball-6  { background: rgba(255,214,0,.2);   border-color: var(--gold);  color: var(--gold); }
  .ball-W  { background: rgba(255,23,68,.2);   border-color: var(--red);   color: var(--red); }
  .ball-nb, .ball-wd { background: rgba(129,199,132,.15); border-color: #81c784; color: #81c784; }

  /* â”€â”€ Loading / Error â”€â”€ */
  .loading-wrap {
    display: flex; flex-direction: column; align-items: center; justify-content: center;
    min-height: 200px; gap: 1rem;
    color: var(--muted);
  }
  .spinner {
    width: 40px; height: 40px;
    border: 3px solid var(--border);
    border-top-color: var(--green);
    border-radius: 50%;
    animation: rotate .8s linear infinite;
  }
  @keyframes rotate { to { transform: rotate(360deg); } }

  .error-box {
    background: rgba(255,23,68,.07);
    border: 1px solid rgba(255,23,68,.25);
    border-radius: 8px;
    padding: 1rem 1.2rem;
    color: #ef9a9a;
    font-size: .85rem;
    margin-bottom: 1.5rem;
  }

  /* â”€â”€ Footer â”€â”€ */
  footer {
    position: relative; z-index: 5;
    text-align: center;
    padding: 1.5rem;
    font-size: .72rem; color: var(--muted);
    border-top: 1px solid var(--border);
  }
  footer a { color: var(--green); text-decoration: none; }

  /* â”€â”€ Responsive â”€â”€ */
  @media (max-width: 600px) {
    header, .api-bar, .ai-bar, main { padding-left: 1rem; padding-right: 1rem; }
    .matches-grid { grid-template-columns: 1fr; }
    #ai-response { margin: 1rem; }
  }
</style>
</head>
<body>

<!-- â•â• HEADER â•â• -->
<header>
  <div class="logo">
    <span class="logo-icon">ğŸ</span>
    <div>
      <div class="logo-text">CricAI Dashboard</div>
      <div class="logo-sub">Live Scores + AI Insights</div>
    </div>
  </div>
  <div class="header-right">
    <div class="live-badge"><div class="live-dot"></div> Live</div>
    <div id="clock">--:--:--</div>
  </div>
</header>

<!-- â•â• API CONFIG BAR â•â• -->
<div class="api-bar">
  <label>ğŸ”‘ CricketData</label>
  <input type="hidden" id="cricket-key" value="*************************************************" /> <!-- Placeholder for security, replace with actual key  CricketData API -->
  <button class="btn" onclick="loadLiveData()">Load Live Scores</button>
  <button class="btn btn-demo" onclick="loadDemoData()">â–¶ Demo Mode (no key)</button>
  <!--- Free key â†’ <a href="https://cricketdata.org/signup.aspx" target="_blank">cricketdata.org/signup</a> (100 hits/day free) -->
</div>

<!-- â•â• GROQ AI BAR â•â• -->
<div class="ai-bar">
  <span class="ai-label">ğŸ¤– Ask AI</span>
  <input type="hidden" id="groq-key" value="gsk_***********************************************" /> <!-- Placeholder for security, replace with actual key Groq (Llama 3.3) -->
  <input type="text" id="ai-question" placeholder="Ask anythingâ€¦ e.g. Who is batting best today?" />
  <button class="btn-ai" onclick="askAI()">Ask AI âœ¦</button>
</div>

<!-- â•â• AI RESPONSE â•â• -->
<div id="ai-response">
  <div class="ai-response-header">âœ¦ AI Insight</div>
  <div id="ai-text"></div>
</div>

<!-- â•â• MAIN â•â• -->
<main>
  <!-- Stats Row -->
  <div class="stats-row" id="stats-row">
    <div class="stat-card"><span class="stat-icon">ğŸŸ¢</span><div><div class="stat-val" id="s-live">â€”</div><div class="stat-lbl">Live Matches</div></div></div>
    <div class="stat-card"><span class="stat-icon">ğŸ“…</span><div><div class="stat-val" id="s-upcoming">â€”</div><div class="stat-lbl">Upcoming</div></div></div>
    <div class="stat-card"><span class="stat-icon">âœ…</span><div><div class="stat-val" id="s-result">â€”</div><div class="stat-lbl">Results Today</div></div></div>
    <div class="stat-card"><span class="stat-icon">ğŸŸï¸</span><div><div class="stat-val" id="s-total">â€”</div><div class="stat-lbl">Total Matches</div></div></div>
  </div>

  <!-- Live Matches -->
  <div class="section-title">ğŸŸ¢ Live Matches</div>
  <div class="matches-grid" id="live-matches">
    <div class="loading-wrap"><div class="spinner"></div><span>Load live scores or try Demo Mode above</span></div>
  </div>

  <!-- Upcoming -->
  <div class="section-title">ğŸ“… Upcoming</div>
  <div class="matches-grid" id="upcoming-matches">
    <div class="loading-wrap"><span style="color:var(--muted)">Waiting for dataâ€¦</span></div>
  </div>

  <!-- Scoreboard detail -->
  <div class="section-title">ğŸ“Š Featured Scorecard</div>
  <div id="scoreboard-detail"></div>
</main>

<footer>
  CricAI Dashboard &nbsp;|&nbsp; Free Cricket API</a>
</footer>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â• SCRIPTS â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<script>
/* â”€â”€ Clock â”€â”€ */
function updateClock() {
  document.getElementById('clock').textContent = new Date().toLocaleTimeString();
}
setInterval(updateClock, 1000);
updateClock();

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   DEMO DATA  (no API key needed)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
const DEMO_MATCHES = [
  {
    id: "demo1", status: "live", type: "TEST",
    team1: { name: "India", flag: "ğŸ‡®ğŸ‡³", score: "324/5", overs: "88.3", batting: true },
    team2: { name: "England", flag: "ğŸ´ó §ó ¢ó ¥ó ®ó §ó ¿", score: "287/10", overs: "92.0", batting: false },
    crr: "CRR: 3.66", venue: "Lord's, London", note: "India need 87 runs"
  },
  {
    id: "demo2", status: "live", type: "T20I",
    team1: { name: "Pakistan", flag: "ğŸ‡µğŸ‡°", score: "143/6", overs: "17.4", batting: true },
    team2: { name: "Australia", flag: "ğŸ‡¦ğŸ‡º", score: "201/4", overs: "20.0", batting: false },
    crr: "CRR: 8.09", venue: "Dubai International", note: "Pakistan need 59 off 14 balls"
  },
  {
    id: "demo3", status: "result", type: "ODI",
    team1: { name: "South Africa", flag: "ğŸ‡¿ğŸ‡¦", score: "312/7", overs: "50.0", batting: false },
    team2: { name: "New Zealand", flag: "ğŸ‡³ğŸ‡¿", score: "289/10", overs: "47.2", batting: false },
    crr: "", venue: "Cape Town", note: "South Africa won by 23 runs"
  },
  {
    id: "demo4", status: "upcoming", type: "T20I",
    team1: { name: "Sri Lanka", flag: "ğŸ‡±ğŸ‡°", score: "â€”", overs: "" },
    team2: { name: "Bangladesh", flag: "ğŸ‡§ğŸ‡©", score: "â€”", overs: "" },
    crr: "", venue: "Colombo, SSC", note: "Starts at 14:30 IST"
  },
  {
    id: "demo5", status: "upcoming", type: "ODI",
    team1: { name: "West Indies", flag: "ğŸï¸", score: "â€”", overs: "" },
    team2: { name: "Zimbabwe", flag: "ğŸ‡¿ğŸ‡¼", score: "â€”", overs: "" },
    crr: "", venue: "Bridgetown, Barbados", note: "Starts at 16:00 IST"
  }
];

const DEMO_SCORECARD = {
  title: "India vs England â€” 1st Test",
  score: "324/5 (88.3 ov)",
  batters: [
    { name: "Rohit Sharma", runs: 87, balls: 142, fours: 9, sixes: 2, sr: "61.26", out: false },
    { name: "Shubman Gill", runs: 110, balls: 195, fours: 13, sixes: 1, sr: "56.41", out: true },
    { name: "Virat Kohli", runs: 58, balls: 90,  fours: 6, sixes: 0, sr: "64.44", out: true },
    { name: "KL Rahul",    runs: 43, balls: 67,  fours: 4, sixes: 0, sr: "64.17", out: false }
  ],
  bowlers: [
    { name: "James Anderson", overs: "22.0", maidens: 5, runs: 62, wkts: 2, econ: "2.81" },
    { name: "Stuart Broad",   overs: "20.3", maidens: 3, runs: 71, wkts: 2, econ: "3.46" },
    { name: "Ben Stokes",     overs: "15.0", maidens: 1, runs: 55, wkts: 1, econ: "3.66" }
  ],
  balls: ["1","0","4","W","2","1","6","0","1","4","2","1","0","1","W","3","1","4"]
};

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   RENDER FUNCTIONS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function statusBadge(s) {
  if (s === "live")     return `<span class="match-status status-live">ğŸ”´ Live</span>`;
  if (s === "result")   return `<span class="match-status status-result">âœ… Result</span>`;
  return `<span class="match-status status-upcoming">ğŸ• Upcoming</span>`;
}

function renderCard(m) {
  const t1batting = m.team1.batting ? 'batting' : '';
  const t2batting = m.team2.batting ? 'batting' : '';
  return `
  <div class="match-card" onclick="showScorecard('${m.id}')">
    <div class="card-header">
      <span class="match-type">${m.type}</span>
      ${statusBadge(m.status)}
    </div>
    <div class="card-body">
      <div class="teams">
        <div class="team-row">
          <div class="team-info">
            <span class="team-flag">${m.team1.flag}</span>
            <span class="team-name">${m.team1.name}</span>
          </div>
          <div>
            <div class="team-score ${t1batting}">${m.team1.score}</div>
            ${m.team1.overs ? `<div class="team-overs">(${m.team1.overs})</div>` : ''}
          </div>
        </div>
        <div class="divider"></div>
        <div class="team-row">
          <div class="team-info">
            <span class="team-flag">${m.team2.flag}</span>
            <span class="team-name">${m.team2.name}</span>
          </div>
          <div>
            <div class="team-score ${t2batting}">${m.team2.score}</div>
            ${m.team2.overs ? `<div class="team-overs">(${m.team2.overs})</div>` : ''}
          </div>
        </div>
      </div>
    </div>
    <div class="card-footer">
      <span class="venue">ğŸ“ ${m.venue}</span>
      <span class="crr">${m.crr || m.note || ''}</span>
    </div>
  </div>`;
}

function renderMatches(matches) {
  const live     = matches.filter(m => m.status === "live");
  const upcoming = matches.filter(m => m.status === "upcoming");
  const result   = matches.filter(m => m.status === "result");

  document.getElementById('s-live').textContent     = live.length;
  document.getElementById('s-upcoming').textContent = upcoming.length;
  document.getElementById('s-result').textContent   = result.length;
  document.getElementById('s-total').textContent    = matches.length;

  const liveEl = document.getElementById('live-matches');
  liveEl.innerHTML = [...live, ...result].map(renderCard).join('') || '<div class="loading-wrap"><span>No live matches right now</span></div>';

  const upEl = document.getElementById('upcoming-matches');
  upEl.innerHTML = upcoming.map(renderCard).join('') || '<div class="loading-wrap"><span>No upcoming matches scheduled</span></div>';
}

function showScorecard(id) {
  renderScorecard(DEMO_SCORECARD);
  document.getElementById('scoreboard-detail').scrollIntoView({ behavior: 'smooth' });
}

function renderScorecard(sc) {
  const batRows = sc.batters.map(b => `
    <tr>
      <td>${b.name}${b.out ? '' : ' <span class="batting-icon">ğŸ</span>'}</td>
      <td class="${b.out ? 'wicket' : 'highlight'}">${b.runs}</td>
      <td>${b.balls}</td>
      <td>${b.fours}</td>
      <td>${b.sixes}</td>
      <td class="highlight">${b.sr}</td>
    </tr>`).join('');

  const bowlRows = sc.bowlers.map(b => `
    <tr>
      <td>${b.name}</td>
      <td>${b.overs}</td>
      <td>${b.maidens}</td>
      <td>${b.runs}</td>
      <td class="wicket">${b.wkts}</td>
      <td class="highlight">${b.econ}</td>
    </tr>`).join('');

  const ballsHtml = sc.balls.map(b => {
    let cls = 'ball-' + b;
    if (!['0','1','2','3','4','6','W','nb','wd'].includes(b)) cls = 'ball-1';
    return `<div class="ball ${cls}">${b}</div>`;
  }).join('');

  document.getElementById('scoreboard-detail').innerHTML = `
  <div class="scoreboard-wrap">
    <div class="scoreboard-head">
      <span class="scoreboard-title">${sc.title}</span>
      <span class="score-big">${sc.score}</span>
    </div>
    <table>
      <thead><tr><th>Batter</th><th>R</th><th>B</th><th>4s</th><th>6s</th><th>SR</th></tr></thead>
      <tbody>${batRows}</tbody>
    </table>
    <div style="padding:.5rem 1rem;font-size:.75rem;color:var(--muted);border-top:1px solid var(--border)">BOWLING</div>
    <table>
      <thead><tr><th>Bowler</th><th>O</th><th>M</th><th>R</th><th>W</th><th>Econ</th></tr></thead>
      <tbody>${bowlRows}</tbody>
    </table>
    <div style="padding:.6rem 1rem;font-size:.75rem;color:var(--muted);border-top:1px solid var(--border)">LAST 18 BALLS</div>
    <div class="balls-row">${ballsHtml}</div>
  </div>`;
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   LOAD DEMO DATA
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function loadDemoData() {
  renderMatches(DEMO_MATCHES);
  renderScorecard(DEMO_SCORECARD);
  showMsg('âœ… Demo mode loaded! Try clicking any match card.', 'green');
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   LOAD LIVE DATA from CricketData.org
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
async function loadLiveData() {
  const key = document.getElementById('cricket-key').value.trim();
  if (!key) {
    showMsg('âš ï¸ Please enter your CricketData.org API key first, or use Demo Mode.', 'red');
    return;
  }

  document.getElementById('live-matches').innerHTML =
    '<div class="loading-wrap"><div class="spinner"></div><span>Fetching live scoresâ€¦</span></div>';

  try {
    // CricketData.org current matches endpoint
    const url = `https://api.cricketdata.org/cricket/?apikey=${key}&offset=0`;
    const res = await fetch(url);
    const json = await res.json();

    if (json.status !== "success") {
      throw new Error(json.reason || "API error");
    }

    const raw = json.data || [];
    const matches = raw.map(m => ({
      id: m.id,
      status: m.matchStarted && !m.matchEnded ? "live"
            : m.matchEnded ? "result" : "upcoming",
      type: m.matchType?.toUpperCase() || "MATCH",
      team1: {
        name: m.teams?.[0] || "Team 1",
        flag: getFlag(m.teams?.[0]),
        score: m.score?.[0]?.r ? `${m.score[0].r}/${m.score[0].w}` : "â€”",
        overs: m.score?.[0]?.o || "",
        batting: m.tossChoice === m.teams?.[0]
      },
      team2: {
        name: m.teams?.[1] || "Team 2",
        flag: getFlag(m.teams?.[1]),
        score: m.score?.[1]?.r ? `${m.score[1].r}/${m.score[1].w}` : "â€”",
        overs: m.score?.[1]?.o || "",
        batting: m.tossChoice === m.teams?.[1]
      },
      crr: m.status || "",
      venue: m.venue || "â€”",
      note: m.status || ""
    }));

    renderMatches(matches);
    showMsg(`âœ… Loaded ${matches.length} matches from CricketData API!`, 'green');

  } catch (err) {
    document.getElementById('live-matches').innerHTML =
      `<div class="error-box">âŒ API Error: ${err.message}<br><small>Check your key or try Demo Mode above.</small></div>`;
  }
}

function getFlag(name = "") {
  const flags = {
    India:"ğŸ‡®ğŸ‡³", England:"ğŸ´ó §ó ¢ó ¥ó ®ó §ó ¿", Australia:"ğŸ‡¦ğŸ‡º", Pakistan:"ğŸ‡µğŸ‡°",
    "South Africa":"ğŸ‡¿ğŸ‡¦", "New Zealand":"ğŸ‡³ğŸ‡¿", "Sri Lanka":"ğŸ‡±ğŸ‡°",
    Bangladesh:"ğŸ‡§ğŸ‡©", "West Indies":"ğŸï¸", Zimbabwe:"ğŸ‡¿ğŸ‡¼",
    Afghanistan:"ğŸ‡¦ğŸ‡«", Ireland:"ğŸ‡®ğŸ‡ª", UAE:"ğŸ‡¦ğŸ‡ª", Nepal:"ğŸ‡³ğŸ‡µ"
  };
  for (const [k, v] of Object.entries(flags)) {
    if (name.toLowerCase().includes(k.toLowerCase())) return v;
  }
  return "ğŸ";
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   GROQ AI â€” Ask Questions About Scores
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
async function askAI() {
  const groqKey  = document.getElementById('groq-key').value.trim();
  const question = document.getElementById('ai-question').value.trim();

  if (!groqKey) { showMsg('âš ï¸ Enter your free Groq API key first!', 'red'); return; }
  if (!question){ showMsg('âš ï¸ Type a question for the AI.', 'red'); return; }

  const box = document.getElementById('ai-response');
  const txt = document.getElementById('ai-text');
  box.style.display = 'block';
  txt.innerHTML = '<div class="loading-wrap" style="min-height:40px"><div class="spinner"></div></div>';

  // Build context from demo data
  const context = `Current cricket match data:\n${JSON.stringify(DEMO_MATCHES, null, 2)}\n\nFeatured scorecard:\n${JSON.stringify(DEMO_SCORECARD, null, 2)}`;

  try {
    const res = await fetch("https://api.groq.com/openai/v1/chat/completions", {
      method: "POST",
      headers: {
        "Authorization": `Bearer ${groqKey}`,
        "Content-Type": "application/json"
      },
      body: JSON.stringify({
        model: "llama-3.3-70b-versatile",
        messages: [
          {
            role: "system",
            content: `You are a cricket expert AI. Answer questions using the provided match data. Be concise, insightful, and use cricket terminology. Keep answers under 120 words.`
          },
          {
            role: "user",
            content: `Match context:\n${context}\n\nQuestion: ${question}`
          }
        ],
        max_tokens: 256,
        temperature: 0.5
      })
    });

    const data = await res.json();
    if (data.error) throw new Error(data.error.message);
    const answer = data.choices?.[0]?.message?.content || "No response.";
    txt.innerHTML = answer.replace(/\n/g, '<br>');

  } catch (err) {
    txt.innerHTML = `<span style="color:var(--red)">âŒ ${err.message}</span>`;
  }
}

/* â”€â”€ Enter key for AI â”€â”€ */
document.getElementById('ai-question').addEventListener('keydown', e => {
  if (e.key === 'Enter') askAI();
});

/* â”€â”€ Notification helper â”€â”€ */
function showMsg(msg, color) {
  const box = document.getElementById('ai-response');
  const txt = document.getElementById('ai-text');
  box.style.display = 'block';
  txt.innerHTML = `<span style="color:${color === 'red' ? 'var(--red)' : 'var(--green)'}">${msg}</span>`;
}

/* â”€â”€ Auto-load LIVE data on start â”€â”€ */
window.addEventListener('DOMContentLoaded', () => {
  setTimeout(loadLiveData, 400);
});
</script>
</body>
</html>
